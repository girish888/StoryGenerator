<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8"/>
    <title>Words → Story</title>
    <style>
        body {
            background: #0b1220;
            color: #e6eef8;
            font-family: Arial, sans-serif;
            padding: 20px;
        }

        .card {
            background: #0f1a2a;
            padding: 18px;
            border-radius: 8px;
            max-width: 900px;
            margin: auto;
        }

        .error {
            background: #3d1a1a;
            color: #ffd6d6;
            padding: 10px;
            border-radius: 6px;
            margin-bottom: 10px;
        }

        textarea,
        input[type="text"] {
            width: 100%;
            padding: 8px;
            border-radius: 5px;
            border: 1px solid #284054;
            background: #07101a;
            color: #e6eef8;
        }

        button {
            padding: 10px 18px;
            border-radius: 6px;
            background: #1f6feb;
            color: white;
            border: none;
            cursor: pointer;
        }

        pre.story {
            white-space: pre-wrap;
            background: #07101a;
            padding: 12px;
            border-radius: 6px;
            color: #d9f0ff;
        }
    </style>

</head>
<body>
<div class="card">
    <h1>Word → Story</h1>

    <div th:if="${error}" class="error" id="serverError">
        <strong>Error:</strong> <span th:text="${error}">An error occurred</span>
    </div>

    <form th:action="@{/generate}" method="post">
        <label>Enter words (comma separated)</label>
        <textarea name="words" rows="4" placeholder="king, seven sons, kingdom..." th:text="${words}"> </textarea>
        <label>Genre (optional)</label>
        <input type="text" name="genre" placeholder="creative" th:value="${genre}"/>
        <div style="margin-top:10px">
            <button type="submit">Generate Story</button>
        </div>
    </form>

    <h2>Result</h2>
    <pre class="story" th:text="${story}">Your story will appear here.</pre>
</div>

<!-- Inline JS to show a popup when server provided an error -->
<div th:if="${error}">
    <script th:inline="javascript">
        /*<![CDATA[*/
        var err = /*[[${error}]]*/ "Unknown error";
        // show popup with instructions
        alert("Problem: " + err + "\n\nQuick fix:\n1) Create an API key in Google AI Studio\n2) Enable Generative Language API on that project\n3) Set AI_GEMINI_KEY env var or set -Dai.gemini.key when running\n4) Restart the app");
        /*]]>*/
    </script>
</div>
</body>
</html>
